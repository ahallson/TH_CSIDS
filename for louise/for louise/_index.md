```
usage: attirb [-p TIME PERIOD [TIME PERIOD ...]] [-h]
```

Display raw and percentage attributions of sector performance in terms of a selected benchmark (currently only SPY), and the user's portfolio.
Outputs visualisation by sector for both raw and percentage, as well as displaying in terminal.

```
optional arguments:
  -p TIME PERIOD [TIME PERIOD ...]
                        Set the time period for the portfolio. By default, this is all time which uses the first date present in the portfolio.
  -h, --help            show this help message (default: False)
```
Example:
```

2022 Oct 28, 06:03 (🦋) /portfolio/ $ load --file Public_Equity_Orderbook.xlsx
 Preprocessing orderbook: ..........
      Loading price data: .
     Calculating returns: .


Portfolio: Public_Equity_Orderbook.xlsx
Risk Free Rate: 0

2022 Oct 28, 06:03 (🦋) /portfolio/ $ bench SPDR S&P 500 ETF Trust (SPY)

Benchmark: SPDR S&P 500 ETF Trust (SPY) (SPY)

2022 Oct 28, 06:03 (🦋) /portfolio/ $ attrib

                                              Contributions as % of PF: Portfolio vs. Benchmark Attribution Categorisation all
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                             ┃ S&P500 [%] ┃ Portfolio [%] ┃ Excess Attribution ┃ Attribution Ratio ┃ Attribution Direction [+/-] ┃ Attribution Sensitivity ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ S&P 500 Consumer Discretionary (Sector)     │ 13.25      │ 27.98         │ 14.73              │ 2.11              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Consumer Staples (Sector)           │ 5.54       │ 0.0           │ -5.54              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Energy (Sector)                     │ 2.89       │ 0.0           │ -2.89              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Financials (Sector)                 │ 11.36      │ 0.0           │ -11.36             │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Health Care (Sector)                │ 17.15      │ 6.42          │ -10.73             │ 0.37              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Industrials (Sector)                │ 7.12       │ 0.0           │ -7.12              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Information Technology (Sector)     │ 33.67      │ 65.13         │ 31.45              │ 1.93              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Materials (Sector)                  │ 1.73       │ 0.0           │ -1.73              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Real Estate (Sector)                │ 1.92       │ 0.0           │ -1.92              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Telecommunication Services (Sector) │ 3.73       │ 0.48          │ -3.25              │ 0.13              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Utilities (Sector)                  │ 1.63       │ 0.0           │ -1.63              │ 0.0               │ Correlated (+)              │ Low                     │
└─────────────────────────────────────────────┴────────────┴───────────────┴────────────────────┴───────────────────┴─────────────────────────────┴─────────────────────────┘


                                   Raw contributions (Return x PF Weight): Portfolio vs. Benchmark Attribution Categorisation all
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                             ┃ S&P500 ┃ Portfolio ┃ Excess Attribution ┃ Attribution Ratio ┃ Attribution Direction [+/-] ┃ Attribution Sensitivity ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ S&P 500 Consumer Discretionary (Sector)     │ 0.1893 │ 0.8397    │ 0.6504             │ 4.44              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Consumer Staples (Sector)           │ 0.0792 │ 0.0       │ -0.0792            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Energy (Sector)                     │ 0.0413 │ 0.0       │ -0.0413            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Financials (Sector)                 │ 0.1624 │ 0.0       │ -0.1624            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Health Care (Sector)                │ 0.245  │ 0.1926    │ -0.0525            │ 0.79              │ Correlated (+)              │ Normal                  │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Industrials (Sector)                │ 0.1018 │ 0.0       │ -0.1018            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Information Technology (Sector)     │ 0.4811 │ 1.9546    │ 1.4734             │ 4.06              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Materials (Sector)                  │ 0.0246 │ 0.0       │ -0.0246            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Real Estate (Sector)                │ 0.0274 │ 0.0       │ -0.0274            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Telecommunication Services (Sector) │ 0.0533 │ 0.0144    │ -0.039             │ 0.27              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Utilities (Sector)                  │ 0.0232 │ 0.0       │ -0.0232            │ 0.0               │ Correlated (+)              │ Low                     │
└─────────────────────────────────────────────┴────────┴───────────┴────────────────────┴───────────────────┴─────────────────────────────┴─────────────────────────┘


2022 Oct 28, 06:04 (🦋) /portfolio/ $ attrib -p 3m

                                               Contributions as % of PF: Portfolio vs. Benchmark Attribution Categorisation 3m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                             ┃ S&P500 [%] ┃ Portfolio [%] ┃ Excess Attribution ┃ Attribution Ratio ┃ Attribution Direction [+/-] ┃ Attribution Sensitivity ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ S&P 500 Consumer Discretionary (Sector)     │ -13.27     │ -38.77        │ -25.51             │ 2.92              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Consumer Staples (Sector)           │ -4.95      │ 0.0           │ 4.95               │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Energy (Sector)                     │ 24.16      │ 0.0           │ -24.16             │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Financials (Sector)                 │ 4.07       │ 0.0           │ -4.07              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Health Care (Sector)                │ -0.13      │ 8.0           │ 8.12               │ -63.11            │ Uncorrelated (-)            │ High                    │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Industrials (Sector)                │ 0.76       │ 0.0           │ -0.76              │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Information Technology (Sector)     │ -62.43     │ -67.22        │ -4.79              │ 1.08              │ Correlated (+)              │ Normal                  │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Materials (Sector)                  │ -0.72      │ 0.0           │ 0.72               │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Real Estate (Sector)                │ -12.57     │ 0.0           │ 12.57              │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Telecommunication Services (Sector) │ -29.79     │ -2.0          │ 27.79              │ 0.07              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼────────────┼───────────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Utilities (Sector)                  │ -5.13      │ 0.0           │ 5.13               │ -0.0              │ Correlated (+)              │ Low                     │
└─────────────────────────────────────────────┴────────────┴───────────────┴────────────────────┴───────────────────┴─────────────────────────────┴─────────────────────────┘


                                    Raw contributions (Return x PF Weight): Portfolio vs. Benchmark Attribution Categorisation 3m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                             ┃ S&P500  ┃ Portfolio ┃ Excess Attribution ┃ Attribution Ratio ┃ Attribution Direction [+/-] ┃ Attribution Sensitivity ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ S&P 500 Consumer Discretionary (Sector)     │ -0.0048 │ -0.0512   │ -0.0464            │ 10.62             │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Consumer Staples (Sector)           │ -0.0018 │ 0.0       │ 0.0018             │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Energy (Sector)                     │ 0.0088  │ 0.0       │ -0.0088            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Financials (Sector)                 │ 0.0015  │ 0.0       │ -0.0015            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Health Care (Sector)                │ -0.0    │ 0.0106    │ 0.0106             │ -229.42           │ Uncorrelated (-)            │ High                    │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Industrials (Sector)                │ 0.0003  │ 0.0       │ -0.0003            │ 0.0               │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Information Technology (Sector)     │ -0.0227 │ -0.0888   │ -0.0661            │ 3.91              │ Correlated (+)              │ High                    │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Materials (Sector)                  │ -0.0003 │ 0.0       │ 0.0003             │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Real Estate (Sector)                │ -0.0046 │ 0.0       │ 0.0046             │ -0.0              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Telecommunication Services (Sector) │ -0.0108 │ -0.0026   │ 0.0082             │ 0.24              │ Correlated (+)              │ Low                     │
├─────────────────────────────────────────────┼─────────┼───────────┼────────────────────┼───────────────────┼─────────────────────────────┼─────────────────────────┤
│ S&P 500 Utilities (Sector)                  │ -0.0019 │ 0.0       │ 0.0019             │ -0.0              │ Correlated (+)              │ Low                     │
└─────────────────────────────────────────────┴─────────┴───────────┴────────────────────┴───────────────────┴─────────────────────────────┴─────────────────────────┘